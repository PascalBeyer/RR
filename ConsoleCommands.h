#ifndef RR_CONSOLECOMMANDS
#define RR_CONSOLECOMMANDS

static char lorum[] = "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.";



static void HelloHelper(StringArray args)
{
	ConsoleOutput("Hello!");
}

static void LorumHelper(StringArray args)
{
	ConsoleOutput(lorum);
}

static void AddHelper(StringArray args)
{
	b32 success = true;
	u32 inp1 = StoU(args[0], &success);
	u32 inp2 = StoU(args[1], &success);

	if (!success)
	{
		ConsoleOutput("Arguments did not match!");
		return;
	}

	u32 sum = inp1 + inp2;
	ConsoleOutput("%i32 + %i32 = %i32", inp1, inp2, sum);
}


static void ClearHelper(StringArray args)
{
	console.commandHistory->length = 0;
	console.historyLength = 0;
	console.historyPos = 0;
	Clear(console.arena);
}

static void HelpHelper(StringArray args)
{
	ConsoleOutput("Console Commands are:");

	For(console.commands)
	{
		ConsoleOutput("    %s", it->name);
	}
}



static void WriteDebugVariables();
static void WriteSingleTweeker(Tweeker tweeker);

// todo : make this need file names
static void TweekHelper(StringArray args)
{
	if (args.amount == 0)
	{
		For(globalDebugState.tweekers)
		{
			ConsoleOutput("%s %s", it->name, TweekerToString(*it));
		}

		return;
	}

	Tweeker *toTweek = GetTweeker(args[0]);
	
	if(!toTweek) 
	{
		ConsoleOutputError("Error: Tweeker not found!", HistoryEntry_Error); // todo : nearest match?
		return;
	}

	if (args.amount == 1)
	{
		if (toTweek->type == Tweeker_v4)
		{
			ColorPicker picker = CreateColorPicker(toTweek->vec4);
			picker.tweeker = *toTweek;
			EditorUIElement elem = { EditorUI_ColorPicker, picker };
			ArrayAdd(&console.state->editor.elements, elem);
		}

		ConsoleOutput("Current Tweeker Value is: %s", TweekerToString(*toTweek)); 
		return;
	}

	Tweeker save = *toTweek;
	b32 success = true;
	switch (toTweek->type)
	{
	case Tweeker_b32:
	{	
		b32 val = StoB(args[1], &success);
		if (success) toTweek->b = val;
	}break;
	case Tweeker_u32:
	{
		u32 val = StoU(args[1], &success);
		if (success) toTweek->u = val;
	}break;
	case Tweeker_f32:
	{
		f32 val = StoF(args[1], &success);
		if (success) toTweek->f = val;
	}break;

	case Tweeker_v2:
	{
		v2 val = StoV2(args[1], &success);
		if (success) toTweek->vec2 = val;
	}break;

	case Tweeker_v3:
	{
		v3 val = StoV3(args[1], &success);
		if (success) toTweek->vec3 = val;
	}break;
	case Tweeker_v4:
	{
		v4 val = StoV4(args[1], &success);
		if (success) toTweek->vec4 = val;
	}break;
	default:
		ConsoleOutputError("Unhandled Tweeker Type in Tweek Helper!");
		return;
	}

	if (!success)
	{
		ConsoleOutputError("Could not parse the value for tweeker %s", toTweek->name);
		ConsoleOutputError("Value remains: %s", TweekerToString(*toTweek));
		return;
	}

	ConsoleOutput("Tweeked %s: %s -> %s!", toTweek->name, TweekerToString(save), TweekerToString(*toTweek));

	WriteSingleTweeker(*toTweek);
}

static void SaveTweekersHelper(StringArray args)
{
	if (args[0] == "tweekers")
	{
		WriteDebugVariables();
		ConsoleOutput("Saved Tweekers!");
		return;
	}
	

	ConsoleOutput("Don't know what to save! (Could not read input).");
}


static void TweekersHelper(StringArray args)
{
	For(globalDebugState.tweekers)
	{
		ConsoleOutput("%s %s", it->name, TweekerToString(*it));
	}
}

static void GrisuHelper(StringArray args)
{
	b32 success = true;
	f32 ret = StoF(args[0], &success);
	if (success)
	{
		ConsoleOutput("parsed float is %f32", ret);
		Grisu(frameArena, ret);
	}
	else
	{
		ConsoleOutput("Could not read float");
	}
}

static void ConvertHelper(StringArray args)
{
	DeferRestore(frameArena);
	Clear(workingArena);

	String name = args[0];
	String type = EatToCharFromBackRetrunTail(&name, '.');
	if (!name.length)
	{
		ConsoleOutputError("No filetype found!");
		return;
	}

	char* nameToLoad = ToNullTerminated(frameArena, args[0]);		
	if (type == "bmp")
	{
		String nameToSave = FormatString("%stexture\n", name);
		nameToSave[nameToSave.length - 1] = '\0'; // todo  hack... maybe make this a version of format string
		Bitmap bitmap = CreateBitmap(nameToLoad);

		if (!bitmap.pixels)
		{
			ConsoleOutputError("Could not find bitmap %c*.", nameToLoad);
			return;
		}

		if (bitmap.height != AssetBitmapSize || bitmap.width != AssetBitmapSize)
		{
			ConsoleOutputError("Bitmap does not have standart bitmap size.", nameToLoad);
			return;
		}

		WriteTexture((char *)nameToSave.data, bitmap);
		ConsoleOutput("Converted bitmap %c* to texture %s", nameToLoad, nameToSave);
		return;
	} 
	else if(type == "obj")
	{
		String nameToSave = FormatString("%smesh\n", name);
		nameToSave[nameToSave.length - 1] = '\0'; // todo  hack... maybe make this a version of format string
		TriangleMesh mesh = ReadObj(NULL, nameToLoad);
		if (!mesh.vertices.amount)
		{
			ConsoleOutputError("Probably file name wrong. Might have loaded a mesh w/0 vertices.");
			return;
		}
		WriteTriangleMesh(mesh, (char *)nameToSave.data);
		ConsoleOutput("Converted .obj %c* to .mesh %s", nameToLoad, nameToSave);
		return;
	}

	ConsoleOutputError("Unrecognized Format!");
}


#endif // ! RR_CONSOLECOMMANDS

